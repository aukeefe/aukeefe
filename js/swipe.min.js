/*
 * Swipe 2.0
 *
 * Brad Birdsall
 * Copyright 2013, MIT License
 *
*/
function Swipe(e,t){"use strict";function n(){m=b.children,y=m.length,m.length<2&&(t.continuous=!1),p.transitions&&t.continuous&&m.length<3&&(b.appendChild(m[0].cloneNode(!0)),b.appendChild(b.children[1].cloneNode(!0)),m=b.children),g=new Array(m.length),v=e.getBoundingClientRect().width||e.offsetWidth,b.style.width=m.length*v+"px";for(var n=m.length;n--;){var i=m[n];i.style.width=v+"px",i.setAttribute("data-index",n),p.transitions&&(i.style.left=n*-v+"px",s(n,w>n?-v:n>w?v:0,0))}t.continuous&&p.transitions&&(s(a(w-1),-v,0),s(a(w+1),v,0)),p.transitions||(b.style.left=w*-v+"px"),e.style.visibility="visible"}function i(){t.continuous?o(w-1):w&&o(w-1)}function r(){t.continuous?o(w+1):w<m.length-1&&o(w+1)}function a(e){return(m.length+e%m.length)%m.length}function o(e,n){if(w!=e){if(p.transitions){var i=Math.abs(w-e)/(w-e);if(t.continuous){var r=i;i=-g[a(e)]/v,i!==r&&(e=-i*m.length+e)}for(var o=Math.abs(w-e)-1;o--;)s(a((e>w?e:w)-o-1),v*i,0);e=a(e),s(w,v*i,n||x),s(e,0,n||x),t.continuous&&s(a(e-i),-(v*i),0)}else e=a(e),c(w*-v,e*-v,n||x);w=e,f(t.callback&&t.callback(w,m[w]))}}function s(e,t,n){l(e,t,n),g[e]=t}function l(e,t,n){var i=m[e],r=i&&i.style;r&&(r.webkitTransitionDuration=r.MozTransitionDuration=r.msTransitionDuration=r.OTransitionDuration=r.transitionDuration=n+"ms",r.webkitTransform="translate("+t+"px,0)"+"translateZ(0)",r.msTransform=r.MozTransform=r.OTransform="translateX("+t+"px)")}function c(e,n,i){if(!i)return b.style.left=n+"px",void 0;var r=+new Date,a=setInterval(function(){var o=+new Date-r;return o>i?(b.style.left=n+"px",k&&u(),t.transitionEnd&&t.transitionEnd.call(event,w,m[w]),clearInterval(a),void 0):(b.style.left=(n-e)*(Math.floor(100*(o/i))/100)+e+"px",void 0)},4)}function u(){A=setTimeout(r,k)}function d(){k=0,clearTimeout(A)}var h=function(){},f=function(e){setTimeout(e||h,0)},p={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(e){var t=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in t)if(void 0!==e.style[t[n]])return!0;return!1}(document.createElement("swipe"))};if(e){var m,g,v,y,b=e.children[0];t=t||{};var w=parseInt(t.startSlide,10)||0,x=t.speed||300;t.continuous=void 0!==t.continuous?t.continuous:!0;var A,_,k=t.auto||0,C={},E={},S={handleEvent:function(e){switch(e.type){case"touchstart":this.start(e);break;case"touchmove":this.move(e);break;case"touchend":f(this.end(e));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":f(this.transitionEnd(e));break;case"resize":f(n.call())}t.stopPropagation&&e.stopPropagation()},start:function(e){var t=e.touches[0];C={x:t.pageX,y:t.pageY,time:+new Date},_=void 0,E={},b.addEventListener("touchmove",this,!1),b.addEventListener("touchend",this,!1)},move:function(e){if(!(e.touches.length>1||e.scale&&1!==e.scale)){t.disableScroll&&e.preventDefault();var n=e.touches[0];E={x:n.pageX-C.x,y:n.pageY-C.y},"undefined"==typeof _&&(_=!!(_||Math.abs(E.x)<Math.abs(E.y))),_||(e.preventDefault(),d(),t.continuous?(l(a(w-1),E.x+g[a(w-1)],0),l(w,E.x+g[w],0),l(a(w+1),E.x+g[a(w+1)],0)):(E.x=E.x/(!w&&E.x>0||w==m.length-1&&E.x<0?Math.abs(E.x)/v+1:1),l(w-1,E.x+g[w-1],0),l(w,E.x+g[w],0),l(w+1,E.x+g[w+1],0)))}},end:function(){var e=+new Date-C.time,n=Number(e)<250&&Math.abs(E.x)>20||Math.abs(E.x)>v/2,i=!w&&E.x>0||w==m.length-1&&E.x<0;t.continuous&&(i=!1);var r=E.x<0;_||(n&&!i?(r?(t.continuous?(s(a(w-1),-v,0),s(a(w+2),v,0)):s(w-1,-v,0),s(w,g[w]-v,x),s(a(w+1),g[a(w+1)]-v,x),w=a(w+1)):(t.continuous?(s(a(w+1),v,0),s(a(w-2),-v,0)):s(w+1,v,0),s(w,g[w]+v,x),s(a(w-1),g[a(w-1)]+v,x),w=a(w-1)),t.callback&&t.callback(w,m[w])):t.continuous?(s(a(w-1),-v,x),s(w,0,x),s(a(w+1),v,x)):(s(w-1,-v,x),s(w,0,x),s(w+1,v,x))),b.removeEventListener("touchmove",S,!1),b.removeEventListener("touchend",S,!1)},transitionEnd:function(e){parseInt(e.target.getAttribute("data-index"),10)==w&&(k&&u(),t.transitionEnd&&t.transitionEnd.call(e,w,m[w]))}};return n(),k&&u(),p.addEventListener?(p.touch&&b.addEventListener("touchstart",S,!1),p.transitions&&(b.addEventListener("webkitTransitionEnd",S,!1),b.addEventListener("msTransitionEnd",S,!1),b.addEventListener("oTransitionEnd",S,!1),b.addEventListener("otransitionend",S,!1),b.addEventListener("transitionend",S,!1)),window.addEventListener("resize",S,!1)):window.onresize=function(){n()},{setup:function(){n()},slide:function(e,t){d(),o(e,t)},prev:function(){d(),i()},next:function(){d(),r()},getPos:function(){return w},getNumSlides:function(){return y},kill:function(){d(),b.style.width="auto",b.style.left=0;for(var e=m.length;e--;){var t=m[e];t.style.width="100%",t.style.left=0,p.transitions&&l(e,0,0)}p.addEventListener?(b.removeEventListener("touchstart",S,!1),b.removeEventListener("webkitTransitionEnd",S,!1),b.removeEventListener("msTransitionEnd",S,!1),b.removeEventListener("oTransitionEnd",S,!1),b.removeEventListener("otransitionend",S,!1),b.removeEventListener("transitionend",S,!1),window.removeEventListener("resize",S,!1)):window.onresize=null}}}}(window.jQuery||window.Zepto)&&function(e){e.fn.Swipe=function(t){return this.each(function(){e(this).data("Swipe",new Swipe(e(this)[0],t))})}}(window.jQuery||window.Zepto);